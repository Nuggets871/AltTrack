<div class="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-base-300 to-base-200 p-4">
  <div class="fixed top-4 right-4 sm:top-8 sm:right-8 z-50">
    <label class="flex cursor-pointer gap-2 sm:gap-3 items-center px-3 sm:px-4 py-2 rounded-full bg-base-100/80 backdrop-blur-sm shadow-lg hover:shadow-xl transition-shadow border border-base-300/50">
      <app-lottie-icon
        #sunIcon
        iconName="sun"
        [width]="24"
        [height]="24"
        [loop]="false"
        [autoplay]="false"
        class="cursor-pointer">
      </app-lottie-icon>
      <input
        type="checkbox"
        class="toggle toggle-xs sm:toggle-sm theme-controller"
        [checked]="isDarkMode()"
        (change)="onThemeChange($event)" />
      <app-lottie-icon
        #moonIcon
        iconName="moon"
        [width]="24"
        [height]="24"
        [loop]="false"
        [autoplay]="false"
        class="cursor-pointer">
      </app-lottie-icon>
    </label>
  </div>
  <div class="card w-full max-w-md bg-base-100 shadow-2xl border border-base-300">
    <div class="card-body">
      <div class="text-center mb-8">
        <h2 class="card-title text-4xl font-bold justify-center text-primary mb-2">
          Inscription
        </h2>
        <p class="text-base-content/60 text-sm">
          Cr√©ez votre compte AltTrack
        </p>
      </div>

      @if (errorMessage()) {
        <div role="alert" class="alert alert-error mb-6 gap-3">
          <i class="lni lni-circle-check text-lg"></i>
          <span class="text-sm">{{ errorMessage() }}</span>
        </div>
      }

      <form (ngSubmit)="onSubmit()" class="space-y-5">
        <div class="form-control">
          <label class="label pb-2">
            <span class="label-text font-medium text-base-content">
              Nom d'utilisateur
            </span>
          </label>
          <div class="relative">
            <span class="absolute left-0 top-0 bottom-0 flex items-center pl-3 text-base-content/50 z-10 pointer-events-none">
              <i class="lni lni-user-4 text-lg"></i>
            </span>
            <input
              type="text"
              [value]="username()"
              (input)="updateUsername($any($event.target).value)"
              placeholder="Entrez votre nom d'utilisateur"
              class="input input-bordered w-full pl-10 focus:input-primary transition-all"
              [class.input-error]="!usernameValidation().isValid && username() !== ''"
              [disabled]="isLoading()"
              maxlength="50"
            />
          </div>
          @if (!usernameValidation().isValid && username() !== '') {
            <div aria-label="status" class="label pt-2">
              <span class="label-text-alt text-error text-xs inline-flex items-center gap-1.5">
                <span class="status status-error status-sm"></span>
                {{ usernameValidation().message }}
              </span>
            </div>
          }
        </div>

        <div class="form-control">
          <label class="label pb-2">
            <span class="label-text font-medium text-base-content">
              Mot de passe
            </span>
          </label>
          <div class="relative">
            <span class="absolute left-0 top-0 bottom-0 flex items-center pl-3 text-base-content/50 z-10 pointer-events-none">
              <i class="lni lni-locked-2 text-lg"></i>
            </span>
            <input
              type="password"
              [value]="password()"
              (input)="updatePassword($any($event.target).value)"
              placeholder="Entrez votre mot de passe"
              class="input input-bordered w-full pl-10 focus:input-primary transition-all"
              [class.input-error]="!passwordValidation().isValid && password() !== ''"
              [disabled]="isLoading()"
            />
          </div>
          @if (!passwordValidation().isValid && password() !== '') {
            <div aria-label="status" class="label pt-2">
              <span class="label-text-alt text-error text-xs inline-flex items-center gap-1.5">
                <span class="status status-error status-sm"></span>
                {{ passwordValidation().message }}
              </span>
            </div>
          }
        </div>

        <div class="form-control">
          <label class="label pb-2">
            <span class="label-text font-medium text-base-content">
              Confirmer le mot de passe
            </span>
          </label>
          <div class="relative">
            <span class="absolute left-0 top-0 bottom-0 flex items-center pl-3 text-base-content/50 z-10 pointer-events-none">
              <i class="lni lni-locked-2 text-lg"></i>
            </span>
            <input
              type="password"
              [value]="confirmPassword()"
              (input)="updateConfirmPassword($any($event.target).value)"
              placeholder="Confirmez votre mot de passe"
              class="input input-bordered w-full pl-10 focus:input-primary transition-all"
              [class.input-error]="!confirmPasswordValidation().isValid && confirmPassword() !== ''"
              [disabled]="isLoading()"
            />
          </div>
          @if (!confirmPasswordValidation().isValid && confirmPassword() !== '') {
            <div aria-label="status" class="label pt-2">
              <span class="label-text-alt text-error text-xs inline-flex items-center gap-1.5">
                <span class="status status-error status-sm"></span>
                {{ confirmPasswordValidation().message }}
              </span>
            </div>
          }
        </div>

        <div class="form-control mt-8">
          <button
            type="submit"
            class="btn btn-primary w-full gap-2 font-semibold"
            [disabled]="isLoading()">
            @if (isLoading()) {
              <span class="loading loading-spinner loading-sm"></span>
              <span>Inscription en cours...</span>
            } @else {
              <i class="lni lni-user-add text-lg"></i>
              <span>S'inscrire</span>
            }
          </button>
        </div>
      </form>

      <div class="divider text-xs text-base-content/50 my-6">ou se connecter</div>

      <a
        routerLink="/login"
        class="btn btn-outline btn-primary w-full gap-2 font-medium transition-all hover:bg-primary/10">
        <i class="lni lni-arrow-left text-lg"></i>
        Se connecter
      </a>
    </div>
  </div>
</div>

